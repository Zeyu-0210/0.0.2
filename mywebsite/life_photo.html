<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>林泽宇 - 摄影</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body class="photo-page-body">
    <!-- 左上角返回按钮：返回生活页面 -->
    <div class="top-left-controls">
        <a href="life.html" class="home-button" data-lang="home">返回我的生活</a>
    </div>
    
    <!-- 摄影页面主容器 -->
    <div class="photo-container">
        <!-- 标题区域：包含动态粒子效果 -->
        <div class="title-container">
            <!-- 主标题：支持中英文切换 -->
            <h1 class="photo-main-title" data-lang="photoTitle">PHOTOGRAPHY</h1>
            <!-- 粒子动画画布 -->
            <canvas id="particle-canvas"></canvas>
        </div>
        
        <!-- 画廊包装器：包含导航按钮和图片网格 -->
        <div class="gallery-wrapper">
            <!-- 上一页按钮 -->
            <button class="gallery-nav prev" id="prev-page" aria-label="Previous Page">&#10094;</button>
            
            <!-- 图片网格容器 -->
            <div class="photo-grid">
                <!-- 图片项目：使用懒加载优化性能 -->
                <div class="grid-item"><img src="livesresource/adc756123afc99769d260d422c7f36cf.jpg" loading="lazy"></div>
                <div class="grid-item"><img src="livesresource/0d9e634bca1688ae01db764e94047c72.jpg" loading="lazy"></div>
                <div class="grid-item"><img src="livesresource/bb9a55519511c5b734e85f130e4b97ef.jpg" loading="lazy"></div>
                <div class="grid-item"><img src="livesresource/876a31035c26f8e22b06026382536b77.jpg" loading="lazy"></div>
                <div class="grid-item"><img src="livesresource/f87741d09dea97ca1da2dfb501bf87ca.jpg" loading="lazy"></div>
                <div class="grid-item"><img src="livesresource/f55e0d3c947997515fc43e78b6608856.jpg" loading="lazy"></div>
                <div class="grid-item"><img src="livesresource/241c701e263cdfd82640498ce83b0616.jpg" loading="lazy"></div>
                <div class="grid-item"><img src="livesresource/7cfe33654221144a67329eb1d83e9866.jpg" loading="lazy"></div>
                <div class="grid-item"><img src="livesresource/b3566f2761faf37c46dd145e1e5a3afe.jpg" loading="lazy"></div>
                <div class="grid-item"><img src="livesresource/75d096d8bb97fa6999c46f6f82726a1f.jpg" loading="lazy"></div>
                <div class="grid-item"><img src="livesresource/69c9a738125aed97ccc0277f0a26cd42.jpg" loading="lazy"></div>
                <div class="grid-item"><img src="livesresource/c78c4c80dd61331eee1fc4d6b591297b.jpg" loading="lazy"></div>
                <div class="grid-item"><img src="livesresource/08ab76a0187657319d2731a838a3c608.jpg" loading="lazy"></div>
                <div class="grid-item"><img src="livesresource/812a7824c3ea4ce088e3b020219d0a8b.jpg" loading="lazy"></div>
                <div class="grid-item"><img src="livesresource/d9ee1809b285a65c61e794777140ba98.jpg" loading="lazy"></div>
                <div class="grid-item"><img src="livesresource/1ffef332e9ca7dffc460461f1e9179dd.jpg" loading="lazy"></div>
                <div class="grid-item"><img src="livesresource/6e0910a4ff4cc99b83b543c8a3ccd584.jpg" loading="lazy"></div>
                <div class="grid-item"><img src="livesresource/266a23aad072b5b34f3155cb0088d455.jpg" loading="lazy"></div>
                <div class="grid-item"><img src="livesresource/27e76032e05fa57d147c85279f5afa28.jpg" loading="lazy"></div>
                <div class="grid-item"><img src="livesresource/21c6c650f0be01a29da26c3874d9cfb0.jpg" loading="lazy"></div>
                <div class="grid-item"><img src="livesresource/bdc3c8b6de7a4d4da415e71fe94120e4.jpg" loading="lazy"></div>
                <div class="grid-item"><img src="livesresource/808228faa5d1dee9424e635dcbd6fb78.jpg" loading="lazy"></div>
                <div class="grid-item"><img src="livesresource/2a25a819375e43ee37e05331c87eb8c8.jpg" loading="lazy"></div>
                <div class="grid-item"><img src="livesresource/b86ca000bccc7dc9656acf80e6f09e55.jpg" loading="lazy"></div>
                <div class="grid-item"><img src="livesresource/59bfe613017e16f374c9cd07139ca193.jpg" loading="lazy"></div>
                <div class="grid-item"><img src="livesresource/8bd15964e82f33385079605efdcb6e94.jpg" loading="lazy"></div>
                <div class="grid-item"><img src="livesresource/fae12265131219c87bab50be2da457d6.jpg" loading="lazy"></div>
                <div class="grid-item"><img src="livesresource/bd9ea3a627aa3a7562aa202ce84ec375.jpg" loading="lazy"></div>
                <div class="grid-item"><img src="livesresource/69682a0a49ce416d6a644943ec0c858d.jpg" loading="lazy"></div>
                <div class="grid-item"><img src="livesresource/203ad20f349347ab32283cbf13a8e9a4.jpg" loading="lazy"></div>
                <div class="grid-item"><img src="livesresource/d7a9a12322f63c2ea9d81c0a7171fa48.jpg" loading="lazy"></div>
                <div class="grid-item"><img src="livesresource/88fa3faaa9fc24f50ee3377766ba848e.jpg" loading="lazy"></div>
            </div>
            
            <!-- 下一页按钮 -->
            <button class="gallery-nav next" id="next-page" aria-label="Next Page">&#10095;</button>
        </div>
    </div>
    
    <!-- 引入全局控制脚本 -->
    <script src="global-controls.js" defer></script>
    
    <!-- 摄影页面特定脚本 -->
    <script>
    /**
     * 启用图片预览功能
     * 点击图片时显示全屏预览弹窗
     * @param {string} containerSelector - 图片容器的CSS选择器
     */
    function enableImagePreview(containerSelector) {
        const container = document.querySelector(containerSelector);
        if (!container) return;

        // 如果预览弹窗不存在，则创建
        if (!document.getElementById('img-preview-modal')) {
            const modal = document.createElement('div');
            modal.id = 'img-preview-modal';
            modal.style.display = 'none';
            modal.innerHTML = '<div class="img-preview-mask"></div><img class="img-preview-img" src="" />';
            document.body.appendChild(modal);
            // 点击弹窗背景关闭预览
            modal.addEventListener('click', () => { modal.style.display = 'none'; });
        }

        const modal = document.getElementById('img-preview-modal');
        const modalImg = modal.querySelector('.img-preview-img');

        // 为容器内的图片添加点击事件
        container.addEventListener('click', function(e) {
            if (e.target.tagName === 'IMG') {
                modalImg.src = e.target.src;
                modal.style.display = 'flex';
            }
        });
    }

    // 页面加载完成后初始化
    document.addEventListener('DOMContentLoaded', () => {
        // 启用图片预览功能
        enableImagePreview('.photo-grid');

        // 获取DOM元素引用
        const photoGrid = document.querySelector('.photo-grid');
        const gridItems = Array.from(document.querySelectorAll('.photo-grid .grid-item'));
        const prevButton = document.getElementById('prev-page');
        const nextButton = document.getElementById('next-page');
        
        // 分页相关变量
        let itemsPerPage;
        let currentPage = 0;
        let totalPages;

        /**
         * 计算布局和分页
         * 根据屏幕宽度动态计算每页显示的图片数量
         */
        function calculateLayout() {
            // 首先显示所有项目以测量位置
            gridItems.forEach(item => item.style.display = 'block');
            
            // 计算每行的列数
            let columns = 0;
            if (gridItems.length > 0) {
                const firstItemTop = gridItems[0].offsetTop;
                for (const item of gridItems) {
                    if (item.offsetTop === firstItemTop) {
                        columns++;
                    } else {
                        break; // 移动到下一行
                    }
                }
            }
            columns = columns > 0 ? columns : 1; // 安全回退

            // 每页显示两行完整的图片
            itemsPerPage = columns * 2;
            totalPages = Math.ceil(gridItems.length / itemsPerPage);
            
            // 确保当前页面在有效范围内
            if (currentPage >= totalPages) {
                currentPage = totalPages - 1;
            }
            
            // 更新画廊显示
            updateGallery();
        }

        /**
         * 更新画廊显示
         * 根据当前页面显示对应的图片
         */
        function updateGallery() {
            if (itemsPerPage === undefined) return;

            // 隐藏所有图片
            gridItems.forEach(item => item.style.display = 'none');
            
            // 显示当前页面的图片
            const startIndex = currentPage * itemsPerPage;
            const endIndex = startIndex + itemsPerPage;
            const pageItems = gridItems.slice(startIndex, endIndex);
            pageItems.forEach(item => item.style.display = 'block');
        }

        // 上一页按钮事件
        prevButton.addEventListener('click', () => {
            currentPage--;
            if (currentPage < 0) {
                currentPage = totalPages - 1; // 循环到最后一页
            }
            updateGallery();
        });

        // 下一页按钮事件
        nextButton.addEventListener('click', () => {
            currentPage++;
            if (currentPage >= totalPages) {
                currentPage = 0; // 循环到第一页
            }
            updateGallery();
        });

        // 初始计算布局
        calculateLayout();

        // 窗口大小改变时重新计算布局
        window.addEventListener('resize', calculateLayout);

        // 悬停效果：突出显示当前图片，淡化其他图片
        photoGrid.addEventListener('mouseover', (event) => {
            const hoveredItem = event.target.closest('.grid-item');
            if (hoveredItem && photoGrid.contains(hoveredItem)) {
                gridItems.forEach(item => {
                    if (item === hoveredItem) {
                        item.classList.remove('masked');
                    } else {
                        item.classList.add('masked');
                    }
                });
            }
        });

        // 鼠标离开时移除所有遮罩效果
        photoGrid.addEventListener('mouseleave', () => {
            gridItems.forEach(item => {
                item.classList.remove('masked');
            });
        });

        // 粒子动画相关代码
        const canvas = document.getElementById('particle-canvas');
        const ctx = canvas.getContext('2d');
        const titleContainer = document.querySelector('.title-container');

        let particlesArray;

        /**
         * 设置画布尺寸以匹配标题容器
         */
        function setCanvasSize() {
            canvas.width = titleContainer.offsetWidth;
            canvas.height = titleContainer.offsetHeight;
        }
        setCanvasSize();

        // 鼠标位置对象
        const mouse = {
            x: null,
            y: null,
            radius: 150
        }

        // 监听鼠标移动事件
        titleContainer.addEventListener('mousemove', 
            function(event) {
                const rect = canvas.getBoundingClientRect();
                mouse.x = event.clientX - rect.left;
                mouse.y = event.clientY - rect.top;
            }
        );

        titleContainer.addEventListener('mouseleave',
            function() {
                mouse.x = null;
                mouse.y = null;
            }
        )

        class Particle {
            constructor(x, y, directionX, directionY, size, color) {
                this.x = x;
                this.y = y;
                this.directionX = directionX;
                this.directionY = directionY;
                this.size = size;
                this.color = color;
            }
            draw() {
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2, false);
                ctx.fillStyle = this.color;
                ctx.fill();
            }
            update() {
                if (this.x > canvas.width || this.x < 0) {
                    this.directionX = -this.directionX;
                }
                if (this.y > canvas.height || this.y < 0) {
                    this.directionY = -this.directionY;
                }

                let dx = mouse.x - this.x;
                let dy = mouse.y - this.y;
                let distance = Math.sqrt(dx*dx + dy*dy);
                if (distance < mouse.radius + this.size){
                    if(mouse.x < this.x && this.x < canvas.width - this.size * 10){
                        this.x += 10;
                    }
                    if(mouse.x > this.x && this.x > this.size * 10){
                        this.x -= 10;
                    }
                    if(mouse.y < this.y && this.y < canvas.height - this.size * 10){
                        this.y += 10;
                    }
                    if(mouse.y > this.y && this.y > this.size * 10){
                        this.y -= 10;
                    }
                }
                this.x += this.directionX;
                this.y += this.directionY;
                this.draw();
            }
        }

        function init() {
            particlesArray = [];
            let numberOfParticles = (canvas.height * canvas.width) / 9000;
            for (let i = 0; i < numberOfParticles; i++) {
                let size = (Math.random() * 2) + 1;
                let x = (Math.random() * ((canvas.width - size * 2) - (size * 2)) + size * 2);
                let y = (Math.random() * ((canvas.height - size * 2) - (size * 2)) + size * 2);
                let directionX = (Math.random() * .4) - .2;
                let directionY = (Math.random() * .4) - .2;
                let color = 'rgba(255, 255, 255, 0.7)';

                particlesArray.push(new Particle(x, y, directionX, directionY, size, color));
            }
        }

        function animate() {
            requestAnimationFrame(animate);
            ctx.clearRect(0,0,canvas.width, canvas.height);

            for (let i = 0; i < particlesArray.length; i++) {
                particlesArray[i].update();
            }
        }

        init();
        animate();

        window.addEventListener('resize', 
            function(){
                setCanvasSize();
                init();
            }
        )
    });
    </script>
</body>
</html> 